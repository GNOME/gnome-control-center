2002-03-28  Richard Hestilow  <hestilow@ximian.com>

	* background-properties-capplet.c (create_dialog),
	background-properties.glade: Add mnemonics.
	(main): Set title to "Background Preferences".

2002-03-21  Seth Nickell  <snickell@stanford.edu>

	* background-properties-capplet.c: (main):

	Set the window icon.

2002-03-21  Seth Nickell  <snickell@stanford.edu>

	* background-properties-capplet.c: (string_to_orientation),
	(update_color_widget_labels_and_visibility),
	(peditor_value_changed), (setup_dialog), (create_dialog):
	* background-properties.glade:

	Recapture some of the more subtle interactions of "Seth's UI".
	Change colour labels when the gradient orientation changes,
	and use mnemonics so the capplet is accessible. Pad and space
	as designed.

	There are still at least two things wrong:

	1) Havoc & Jonathan convinced me that the large button with
	   label was wrong. This should instead look like:
	   http://beauty.stanford.edu/bg_button.png
	   The new format should be right for all image selectors, the
	   old mechanism had serious usability problems.
	2) "No Picture" should be the first toggle

2002-03-19  Richard Hestilow  <hestilow@ximian.com>

	* background-properties-capplet.c:
	(everywhere): Use an ApplierSet instead of passing around
	BGPreferences.
	(real_realize_cb): Call applier_set_redraw.
	(peditor_value_changed): Merge entry in set->prefs,
	and call applier_set_redraw if realized. Also, hide the second
	color option if shading type is solid.
	(setup_dialog): Set data for the second color selector.
	Also, update peditors for new UI.
	(create_dialog): Add previews and labels to radio buttons.
	(main): Create applier set. Also, connect to DnD signals.

	* background-properties.glade: Implement seth's new UI.
	
2002-03-14  Richard Hestilow  <hestilow@ximian.com>

	* background-properties-capplet.c (setup_dialog): Use new enum
	peditors, and convert to using the #defined gconf keys from
	preferences.h.

2002-03-09  Richard Hestilow  <hestilow@ximian.com>

	* background-properties-capplet.c (setup_dialog): Hook up
	the previewing file selector to the FileEntry.

2002-02-27  Kjartan Maraas  <kmaraas@gnome.org>

	* background-properties-capplet.c (main): s/PACKAGE/GETTEXT_PACKAGE/g
	* main.c: Same here.
	
2002-02-17  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties-capplet.c (main)
	(dialog_button_clicked_cb): Switch to instant apply; remove apply
	button

2002-02-12  Lauris Kaplinski  <lauris@ximian.com>

	* background-properties-capplet.c (dialog_button_clicked_cb): Use
	GtkDialog instead of GnomeDialog

2002-02-06  Seth Nickell  <snickell@stanford.edu>

	* background-properties-capplet.c: (drag_motion_cb),
	(drag_leave_cb), (drag_data_received_cb),
	(change_background_type_toggles), (set_background_picture),
	(quit_cb), (main):
	* background-properties.glade:
	* background-properties.glade1:

	More fixes. Change layout in glade a bit, make DND work,
	fix widget previews.
	
2002-02-04  Lauris Kaplinski  <lauris@ximian.com>

	* background-properties-capplet.c (setup_color_widgets): Kill warning
	(set_background_image_preview): Use g_file_test, use g_object_unref
	instead of gdk_pixbuf_unref
	(image_filename_clicked): Use g_signal_connect
	(dialog_button_clicked_cb): Use GtkDialog instead of GnomeDialog
	(realize_2_cb): Comment out to kill warning
	(realize_cb): Ditto
	(real_realize_cb): Ditto
	(string_to_background_type): Treat NULL string as default
	(string_to_orientation): Ditto

2002-01-13  Seth Nickell  <snickell@stanford.edu>

	reviewed by: <delete if not using a buddy>

	* .cvsignore:
	* Makefile.am:
	* background-properties-capplet.c: (set_picture_is_present),
	(string_to_background_type), (background_type_to_string),
	(orientation_to_string), (string_to_orientation),
	(peditor_string_to_orientation), (peditor_orientation_to_string),
	(update_preview_widgets), (get_legacy_settings),
	(setup_color_widgets), (peditor_value_changed),
	(set_background_image_preview), (file_selector_cb),
	(image_filename_clicked), (background_type_toggled),
	(change_background_type_toggles), (background_type_changed),
	(create_dialog), (idle_draw), (dialog_button_clicked_cb), (main):
	* background-properties.glade:
	* background-properties.glade1:
	* background-properties.xml:

2002-01-28  Richard Hestilow  <hestilow@ximian.com>

	* Link to libbackground.la.
	
2002-01-17  Jakub Steiner <jimmac@ximian.com>

	* background-capplet.png: minor tweaks

2002-01-14  Bradford Hovinen  <hovinen@ximian.com>

	* Makefile.am (bin_PROGRAMS): Rename binary gnome2-background-properties

2002-01-02  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties-capplet.c (main): Removed call to set up
	session management - obsolete

2001-12-20  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties-capplet.c: Update
	(main): Use a GtkDialog rather than a GnomeDialog
	(main): Don't put weak ref on gtk_main_quit
	(dialog_button_clicked_cb): Update
	Eliminate compiler warnings

	* Makefile.am: Update

	* background.desktop.in.in (Exec): Update

	* background-properties-capplet.c (dialog_button_clicked_cb):
	Remove call to apply_settings
	(apply_settings): Remove
	(main): Remove apply_only support

2001-12-19  Seth Nickell  <snickell@stanford.edu>

	* background.desktop.in.in:

	Add Categories field so it goes into the right location
	in the panel menus.

2001-12-18  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties-capplet.c: Use gconf_client rather than
	gconf_engine
	(setup_dialog): Use correct path for enabled
	(main): Preload the background settings directory for performance
	Don't #include bonobo.h

	* background.schema: Update keys to use /desktop/gnome/background

	* background-properties-capplet.c (property_change_cb): Remove
	(create_dialog): Return GladeXML, not GtkWidget
	(setup_dialog): Put GladeXML in the signature rather than
	GtkWidget
	(peditor_value_changed): Retrieve color_frame directory rather
	than through Glade
	(real_realize_cb): Ditto
	(setup_dialog): Set color-frame rather than glade-data
	(main): Construct the preview applier here rather than in
	create_dialog
	(main): Unref the applier object when the dialog is destroyed
	(setup_dialog, create_dialog): Put the applier in the signature
	Use weak_ref rather than the destroy signal for all relevant
	objects
	Update GConf keys to use /desktop/gnome/background

2001-12-17  Bradford Hovinen  <hovinen@ximian.com>

	* background.desktop.in.in (Exec): Update

	* background-properties-capplet.c (setup_dialog): Don't hide
	opacity controls
	(dialog_button_clicked_cb): Apply settings after commiting the
	change set
	(peditor_value_changed): Implement
	(setup_dialog): Connect value-changed signals
	(setup_dialog): Store the applier in the preferences object
	(peditor_value_changed): Retrieve the applier from the preferences
	object and use it to apply settings on the preview widget
	(setup_dialog): Connect missing signal
	(setup_dialog): Enabled set_guard call
	(peditor_value_changed): Set the sensitivity of the color frame
	depending on the settings
	(peditor_value_changed): Use correct keys

	* background.schema: Added wallpaper-enabled

	* background-properties-capplet.c (create_dialog): Use
	prefs_widget rather than preview placeholder widget

2001-12-07  Bradford Hovinen  <hovinen@ximian.com>

	* background.schema: Fix default values

	* background-properties-capplet.c (main): Connect the destroy
	signal

	* background.schema: Fix type on opacity schema

	* background-properties-capplet.c (main): Remove use of
	capplet_init, instead do the initialization ourselves (note: this
	means we are no longer a Bonobo control)
	(dialog_button_clicked_cb): Implement
	(main): Show the dialog when we are done constructing it
	(main): NULL-terminate the dialog construction parameters

2001-10-19  Jakub Steiner <jimmac@ximian.com>

	* background-capplet.png: more clear brush

2001-10-12  Bradford Hovinen  <hovinen@ximian.com>

	* Makefile.am ($(oaffile)): Make creation of the .oaf file generic

	* applier.c (render_to_screen): Use standard gdk and gdk_pixbuf
	rather than xlib and gdk_pixbuf_xlib
	(make_root_pixmap): Create a GdkPixmap
	(set_root_pixmap): Accept GdkPixmap and convert to X id

2001-09-28  Bradford Hovinen  <hovinen@ximian.com>

	* preferences.c (preferences_load_from_bonobo_db):
	(preferences_load_from_bonobo_pbag): Use BONOBO_RET_EX rather than
	RETURN_IF_EX; remove the definition of the latter macro

	* applier.c (fill_gradient): Copied from control center 1.4.0
	(render_background): Create the pixbuf first and then pass to
	fill_gradient
	(render_to_screen): Use XLIB_RGB_DITHER_MAX rather than
	GDK_RGB_DITHER_NORMAL

	* Makefile.am: Change the binary name to
	background-properties-control and create a wrapper script from
	../common/wrapper-script.in to be named
	background-properties-capplet
	Remove support for disabling bonobo-conf build

2001-09-22  Bradford Hovinen  <hovinen@ximian.com>

	* applier.c (run_render_pipeline): Create the root pixmap after we
	know about the gradient geometry
	(place_pixbuf):
	(tile_pixbuf): Fix calls to gdk_pixbuf_composite[_color]
	(render_wallpaper): Fix setting of pixbuf_xlate
	(render_background): Fix pixbuf_render_geom here in case the
	gradient geometry is small

2001-09-21  Bradford Hovinen  <hovinen@ximian.com>

	* applier.c: Total reorganization

2001-09-17  Bradford Hovinen  <hovinen@ximian.com>

	* preferences.c (preferences_save): Move from
	applier.c:output_compat_prefs; it really belongs here
	(preferences_class_init): Don't construct an applier here

	* background-properties-capplet.c (setup_dialog): Create a new
	applier for every dialog
	(create_dialog): Create applier locally, just for this one widget
	(apply_settings): Create applier locally and destroy on exit
	(main): Remove call to gnome_window_set_...

2001-09-14  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties-capplet.c (property_change_cb): Use
	applier_render_color_p
	(real_realize_cb): Ditto
	(get_legacy_settings): Set the wallpaper_enabled flag based on the
	value of wallpaper_filename; use (none) as the default for
	wallpaper_filename
	(setup_dialog): Removed unused variable

	* applier.c (applier_render_color_p): Renamed from
	applier_render_gradient_p; check both solid color and gradient

	* preferences.c (preferences_need_color_opts): Removed; use
	applier_render_color_p instead

2001-09-13  Bradford Hovinen  <hovinen@ximian.com>

	* preferences.c (preferences_load_from_bonobo_db):
	(preferences_load_from_bonobo_pbag): Default to TRUE on enabled;
	check value of wallpaper_filename to set wallpaper_enabled if
	wallpaper_enabled could not be found

	* background-properties-capplet.c (setup_dialog):
	(apply_settings): Check for error condition after creating
	preferences object

	* preferences.c (preferences_destroy): Make this static
	(read_color_from_string): Made argument const
	(bonobo_color_to_gdk): Made argument const
	(DB_GET_VALUE): Removed
	(PB_GET_VALUE): Removed
	(preferences_load_from_bonobo_pbag): Use
	local_bonobo_property_bag_client_get_value_{color|filename}
	(preferences_new_from_bonobo_db):
	(preferences_new_from_bonobo_pbag): Deallocate object and return
	NULL if there was an error
	(local_bonobo_property_bag_client_get_value_color):
	(local_bonobo_property_bag_client_get_value_filename): Implement
	(MAKE_GET_SIMPLE): Implement (copy from bonobo-conf)
	(preferences_load_from_bonobo_pbag): Read enabled property
	(preferences_load_from_bonobo_pbag): Forgive wallpaper_enabled and
	enabled not being found

	* applier.c (applier_render_gradient_p): Implement
	(applier_destroy): Make this static

	* preferences.c (preferences_load_from_bonobo_db): Use
	bonobo_config_get_boolean rather than BONOBO_ARG_GET_BOOLEAN
	(DB_GET_VALUE ()). Ditto bonobo_config_get_long
	(preferences_load_from_bonobo_db): Pass ev pointer to each call to
	bonobo_config_get_*
	(preferences_load_from_bonobo_db): Check ev pointer after each
	call to bonobo_config_get_* and return if an exception is set
	(preferences_load_from_bonobo_db): Allow the enabled flag not to
	be present in the database since some older configurations don't
	have it included
	(all): Remove support for compiling without bonobo-conf

2001-09-07  Richard Hestilow  <hestilow@ximian.com>

	* background-properties.glade: Redid UI a bit to add new enabled
	checkbox.
	
	* background-properties.xml: Add default for "wallpaper_enabled".
	
	* preferences.[ch]: New function preferences_need_color_opts.
	(preferences_load_from_bonobo_db): Load wallpaper_enabled from
	bonobo-conf.
	(preferences_load_from_bonobo_pbag): Ditto.

	* applier.[ch]: New function applier_get_wallpaper_pixbuf
	(needed by preferences_need_color_opts, else pixbuf gets created
	twice).

	* background-properties-capplet.c (real_realize_cb): Set
	color frame sensitivity based on preferences_need_color_opts.
	(property_change_cb): Ditto.
	(setup_dialog): Add peditor/guard for wallpaper_enabled. Also,
	set glade object data on the preferences structure as well.
	
2001-09-03  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties-capplet.c (setup_dialog): Apply
	preferences now if the preview widget is already realized

2001-08-28  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties-capplet.c (get_legacy_settings): Retrieve
	the correct value for wallpaper_types

	* applier.c (output_compat_prefs): Output the correct value for
	wallpaperAlign

	* preferences.c (preferences_load_from_bonobo_pbag): Don't adjust
	the opacity if the opacity setting is invalid
	(preferences_load_from_bonobo_db): Ditto

2001-08-27  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties-capplet.c (setup_dialog): Initialize/free
	the CORBA environment structure
	(real_realize_cb): Put into an idle handler, called by
	realize_2_cb, the new timeout handler

	* preferences.c (preferences_load_from_bonobo_pbag): 
	(preferences_load_from_bonobo_db): Extract from preferences_new_*

	* background-properties-capplet.c (property_change_cb):
	(realize_cb): Accept prefs structure in lieu of
	Bonobo_PropertyBag; don't reload the preferences structure from
	the property bag
	(property_change_cb): Call preferences_apply_event to modify the
	preferences structure appropriately
	(property_change_cb):
	(realize_cb): If the preferences structure is marked destroyed,
	just return
	(setup_dialog): Create a preferences structure from the property
	bag given and use that as the extra data passed to callbacks
	(realize_cb): Put into an idle handler real_realize_cb

	* preferences.c (preferences_apply_event): Implement

	* applier.c (output_compat_prefs): Make prefs const

	* applier.[ch]: Have applier_apply_prefs take a const Preferences
	structure

	* preferences.[ch]: Make preferences_clone take a const
	Preferences structure

2001-08-26  Bradford Hovinen  <hovinen@ximian.com>

	* applier.c (renderer_render_background): Remove debugging message
	(renderer_render_wallpaper): Ditto

2001-08-17  Bradford Hovinen  <hovinen@ximian.com>

	* applier.c (renderer_render_wallpaper): Adjust opacity value to
	0...255 scale

	* preferences.c (preferences_new_from_bonobo_pbag):
	(preferences_new_from_bonobo_db): Use correct check to disable
	opacity

2001-08-13  Richard Hestilow  <hestilow@ximian.com>

	* background-properties-capplet.c (setup_dialog): Really
	override enabled this time. Really.

2001-08-13  Richard Hestilow  <hestilow@ximian.com>
 
 	* applier.c (applier_apply_prefs): Only draw disabled message
 	if do_preview. Actually, the user will never see this because
 	the correct behavior (which is done) is to assume if they're
 	running capplet, prefs->enable should be TRUE. This is because
 	we are only honoring enable as a hacker-only setting.
 	(output_compat_prefs): Output the correct "Enable" setting.
 
 	* background-properties-capplet.c (get_legacy_settings): Support
 	the "Enabled" flag. 
 
 	* preferences.c (preferences_new_from_bonobo_db): Import the
 	"enabled" flag. Note that this is not bothered with in the _pbag
 	function, because that's from the Proxy settings, which is only
 	used for the GUI capplet, which always sets enabled to True, because
 	this is a hacker-only option. Got it?

	* background-properties.xml: Add "enabled".

2001-07-31  Chema Celorio  <chema@celorio.com>

	* Makefile.am (cappletname): add DISTDIR to install-data-local

2001-07-27  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties-capplet.c (get_legacy_settings): Fix
	val_ulong in the gradient case

	* RELEASE : 1.5.2

2001-07-26  Bradford Hovinen  <hovinen@ximian.com>

	* applier.c (applier_apply_prefs): Don't try to load the wallpaper
	if it's not enabled

	* preferences.c (preferences_new_from_bonobo_pbag): Use
	bonobo_property_editor_client_get_value_*
	(preferences_new_from_bonobo_pbag): Set gradient_enabled properly
	from property bag
	(preferences_new_from_bonobo_pbag): Check for wallpaper == "(none)"
	(preferences_new_from_bonobo_db): Ditto above

	* applier.c (renderer_render_wallpaper): Restore some lost tweaks
	from earlier.

	* preferences.c (preferences_init): strdup the home directory

	* applier.c: Store preview widget in the renderer, not the applier
	itself

	* background-properties-capplet.c (create_dialog): Add a "(none)"
	string to the history

2001-07-26  Richard Hestilow  <hestilow@ximian.com>

	* applier.c: Remove all bonobo-conf stuff.

	* preferences.[ch]: New functions preferences_new_from_bonobo_pbag
	and preferences_new_from_bonobo_db.

2001-07-26  Bradford Hovinen  <hovinen@ximian.com>

	* background-properties.glade: Tweak borders and padding

	* applier.c (get_geometry): Tweak geometry settings
	(renderer_render_wallpaper): Rendering geometry fixes
	(renderer_render_wallpaper): Remove debugging code

	* background-properties-capplet.c (property_change_cb): Accept
	applier as argument; retrieve property bag from applier
	(realize_cb): Retrieve applier from widget
	(setup_dialog): Store property bag in applier

	* applier.c (renderer_new): Store applier inside renderer; accept
	applier as function parameter

	* background-properties-capplet.c (create_dialog): Store the
	applier inside the widget

	* applier.c (struct _ApplierPrivate ): Define preview_widget here
	rather than globally
	(applier_get_preview_widget): Make this a method of the applier class

2001-07-25  Chema Celorio  <chema@celorio.com>

	* Makefile.am ($(oaffile)): remove the oaffile_IN_RULE macro and copy
	it here
	* Makefile.am: remove the DESKTOP_IN_RULE and copy the sed here

2001-07-24  Bradford Hovinen  <hovinen@ximian.com>

	* main.c (setup_dialog): Use bonobo_peditor_option_menu_construct

2001-07-25  Richard Hestilow  <hestilow@ximian.com>

	* main.c (setup_dialog): Hide opacity settings for now.
	
	* background-properties.glade: Rename opacity label. 

2001-07-24  Richard Hestilow  <hestilow@ximian.com>

	* applier.c (output_compat_prefs): Write to gnome-config to make
	nautilus happy. 
	(applier_apply_prefs): Change of is_nautilus_running handling
	logic to still output legacy settings. Also, call
	output_compat_prefs if is_root
.
2001-07-24  Richard Hestilow  <hestilow@ximian.com>
	
	* main.c (main): Pass in legacy files to capplet_init.

2001-07-23  Bradford Hovinen  <hovinen@ximian.com>

	* applier.c (renderer_render_wallpaper): Don't adjust pixmap width

2001-07-20  Chema Celorio  <chema@celorio.com>

	* RELEASE : 1.5.0

2001-07-19  Chema Celorio  <chema@celorio.com>

	* Makefile.am (cappletname): make distcheck love

2001-07-19  Richard Hestilow  <hestilow@ximian.com>

	* main.c: Add compatibility "-b" argument.

2001-07-19  Richard Hestilow  <hestilow@ximian.com>
	
	* applier.c: remove debugging spew

	* main.c (get_legacy_settings): Fix for FileName corba type.
	(apply_settings): Check to make sure applier exists.

2001-07-19  Bradford Hovinen  <hovinen@ximian.com>

	* Makefile.am: Rename binary to background-properties

2001-07-19  Richard Hestilow  <hestilow@ximian.com>
	
	* background-properties.desktop.in.in: Change exec string for
	bonobo-conf.
 
2001-07-19  Richard Hestilow  <hestilow@ximian.com>
	
	* bonobo-conf rewrite.
 
2001-07-19  Bradford Hovinen  <hovinen@ximian.com>

	* Makefile.am: Remove SUBDIRS
	(background_properties_SOURCES): Added missing applier.h

	* prefs-widget.c: Remove references to auto apply feature

	* applier.c (get_geometry): Use vwidth and vheight rather than
	dwidth and dheight when computing aspect ratio
	(get_geometry): Adjust rwidth and rheight according to above change

	* preferences.c (preferences_changed): Disable auto-apply

	* background-properties.glade: Remove apply automatically check
	button; change "More Solid" to "More Opaque"

2001-07-17  Chema Celorio  <chema@celorio.com>

	* start

